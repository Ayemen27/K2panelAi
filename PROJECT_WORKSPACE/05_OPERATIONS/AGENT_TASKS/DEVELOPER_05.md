# ğŸ‘¤ Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·ÙˆØ± 5 - Terminal Component

> **ğŸ“ Ø£Ù†Øª Ù‡Ù†Ø§**: Ø§Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ø®Ø§Ù…Ø³ - Ø§Ù„Ø·Ø±ÙÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©  
> **â¬…ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚**: [`DEVELOPER_04.md`](DEVELOPER_04.md)  
> **â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ**: [`DEVELOPER_06.md`](DEVELOPER_06.md)  
> **ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯Ù„ÙŠÙ„**: [`../../INDEX.md`](../../INDEX.md)

---

## ğŸ¯ Ù…Ù‡Ù…ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

**Ø£Ù†Øª Ø§Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ø®Ø§Ù…Ø³** - Ù…Ø³Ø¤ÙˆÙ„ÙŠØªÙƒ:
- âœ… **Ø¥Ù†Ø´Ø§Ø¡ Terminal Component** Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… xterm.js
- âœ… **WebSocket Ù„Ù„ØªÙˆØ§ØµÙ„** Ù…Ø¹ Ø§Ù„Ø³ÙŠØ±ÙØ±
- âœ… **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø±** terminal Ù…ÙˆØ¬ÙˆØ¯
- âœ… **ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± Ø­Ù‚ÙŠÙ‚ÙŠØ©** Ø¹Ù† Ø¨ÙØ¹Ø¯
- âœ… **Command history** Ùˆ auto-complete (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
- âœ… **Ø§Ù„ØªØ³Ù„ÙŠÙ… Ù„Ù„Ù…Ø·ÙˆØ± 6** Ù…Ø¹ terminal ÙŠØ¹Ù…Ù„

**ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø¬Ù‡Ø¯**: 4-5 Ø£ÙŠØ§Ù… (32 Ø³Ø§Ø¹Ø©)  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©**: ğŸ”´ Ø­Ø±Ø¬ - Terminal Ù‡Ùˆ Core Feature

---

## âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (Ø¥Ù„Ø²Ø§Ù…ÙŠØ©!)

### **Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡**:
- [ ] âœ… Ø¨Ø­Ø«Øª Ø¹Ù† terminal component Ù…ÙˆØ¬ÙˆØ¯
- [ ] âœ… ÙØ­ØµØª ServerAutomationAI - Ù‡Ù„ ÙŠØ­ØªÙˆÙŠ terminalØŸ
- [ ] âœ… Ø±Ø§Ø¬Ø¹Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø± (Replit, VSCode)
- [ ] âœ… Ø­Ø¯Ø¯Øª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„ØªÙŠ Ø³Ø£Ø³ØªØ®Ø¯Ù…Ù‡Ø§ (xterm.js)

### **Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡**:
- [ ] âœ… ØªØ£ÙƒØ¯Øª Ù…Ù† Ø¹Ø¯Ù… Ø¥Ù†Ø´Ø§Ø¡ terminal logic Ù…ÙƒØ±Ø±
- [ ] âœ… Ø±Ø§Ø¬Ø¹Øª WebSocket - Ù„Ø§ ØªÙƒØ±Ø§Ø± ÙÙŠ connections
- [ ] âœ… ÙˆØ«Ù‘Ù‚Øª ÙÙŠ HANDOFF

---

## ğŸ“‹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

### **Phase 1: Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯** â±ï¸ 4 Ø³Ø§Ø¹Ø§Øª

```bash
# Dependencies (Ø£Ø¶Ù ÙÙŠ package.json):
{
  "dependencies": {
    "xterm": "^5.3.0",
    "xterm-addon-fit": "^0.8.0",
    "xterm-addon-web-links": "^0.9.0",
    "ws": "^8.14.2"
  }
}
```

---

### **Phase 2: Terminal Component** â±ï¸ 12 Ø³Ø§Ø¹Ø§Øª

```typescript
// src/components/workspace/Terminal.tsx

'use client';

import { useEffect, useRef, useState } from 'react';
import { Terminal as XTerm } from 'xterm';
import { FitAddon } from 'xterm-addon-fit';
import { WebLinksAddon } from 'xterm-addon-web-links';
import 'xterm/css/xterm.css';

interface TerminalProps {
  workspaceId: string;
}

export function Terminal({ workspaceId }: TerminalProps) {
  const terminalRef = useRef<HTMLDivElement>(null);
  const xtermRef = useRef<XTerm>();
  const wsRef = useRef<WebSocket>();
  const [connected, setConnected] = useState(false);

  useEffect(() => {
    if (!terminalRef.current) return;

    // Ø¥Ù†Ø´Ø§Ø¡ Terminal
    const xterm = new XTerm({
      cursorBlink: true,
      fontSize: 14,
      fontFamily: 'Menlo, Monaco, "Courier New", monospace',
      theme: {
        background: '#1e1e1e',
        foreground: '#d4d4d4',
      },
    });

    const fitAddon = new FitAddon();
    const webLinksAddon = new WebLinksAddon();

    xterm.loadAddon(fitAddon);
    xterm.loadAddon(webLinksAddon);
    xterm.open(terminalRef.current);
    fitAddon.fit();

    xtermRef.current = xterm;

    // WebSocket connection
    const ws = new WebSocket(
      `${process.env.NEXT_PUBLIC_WS_URL}/terminal/${workspaceId}`
    );

    ws.onopen = () => {
      setConnected(true);
      xterm.writeln('Connected to workspace terminal');
      xterm.write('$ ');
    };

    ws.onmessage = (event) => {
      xterm.write(event.data);
    };

    ws.onerror = () => {
      xterm.writeln('\r\nWebSocket error');
      setConnected(false);
    };

    ws.onclose = () => {
      xterm.writeln('\r\nConnection closed');
      setConnected(false);
    };

    wsRef.current = ws;

    // Ø¥Ø±Ø³Ø§Ù„ input Ù„Ù„Ø³ÙŠØ±ÙØ±
    xterm.onData((data) => {
      if (ws.readyState === WebSocket.OPEN) {
        ws.send(JSON.stringify({ type: 'input', data }));
      }
    });

    // Cleanup
    return () => {
      ws.close();
      xterm.dispose();
    };
  }, [workspaceId]);

  return (
    <div className="h-full flex flex-col bg-gray-900">
      <div className="flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700">
        <h3 className="text-sm font-medium text-gray-200">Terminal</h3>
        <span className={`text-xs ${connected ? 'text-green-400' : 'text-red-400'}`}>
          {connected ? 'â— Connected' : 'â—‹ Disconnected'}
        </span>
      </div>
      <div ref={terminalRef} className="flex-1" />
    </div>
  );
}
```

---

### **Phase 3: WebSocket Server** â±ï¸ 8 Ø³Ø§Ø¹Ø§Øª

```typescript
// src/app/api/terminal/[workspaceId]/route.ts

import { WebSocketServer } from 'ws';
import { spawn } from 'child_process';

export async function GET(
  req: Request,
  { params }: { params: { workspaceId: string } }
) {
  const { workspaceId } = params;

  // Upgrade to WebSocket
  const upgrade = req.headers.get('upgrade');
  if (upgrade !== 'websocket') {
    return new Response('Expected WebSocket', { status: 426 });
  }

  // ÙÙŠ Ø¨ÙŠØ¦Ø© Ø¥Ù†ØªØ§Ø¬ Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ù†Ø³ØªØ®Ø¯Ù… WebSocket server Ù…Ù†ÙØµÙ„
  // Ù‡Ù†Ø§ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… ÙÙ‚Ø·
  
  return new Response('WebSocket endpoint', {
    status: 101,
    headers: {
      'Upgrade': 'websocket',
      'Connection': 'Upgrade',
    },
  });
}
```

**Ù…Ù„Ø§Ø­Ø¸Ø©**: ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ØŒ Ø§Ø³ØªØ®Ø¯Ù… WebSocket server Ù…Ù†ÙØµÙ„ (Ù…Ø«Ù„ ws package)

---

### **Phase 4: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±** â±ï¸ 6 Ø³Ø§Ø¹Ø§Øª

```yaml
Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:

1. Ø§Ù„Ø§ØªØµØ§Ù„:
   - âœ“ Terminal ÙŠØªØµÙ„ Ø¨Ù€ WebSocket
   - âœ“ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© "Connected"
   
2. ØªÙ†ÙÙŠØ° Ø§Ù„Ø£ÙˆØ§Ù…Ø±:
   - âœ“ ØªÙ†ÙÙŠØ°: ls
   - âœ“ ØªÙ†ÙÙŠØ°: pwd
   - âœ“ ØªÙ†ÙÙŠØ°: echo "Hello"
   
3. Output:
   - âœ“ Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø£ÙˆØ§Ù…Ø±
   - âœ“ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
   
4. Reconnection:
   - âœ“ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ù‚Ø·Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„
```

---

## ğŸ“ Deliverables

- [ ] Terminal Component Ø¬Ø§Ù‡Ø²
- [ ] WebSocket integration ÙŠØ¹Ù…Ù„
- [ ] ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± Ø­Ù‚ÙŠÙ‚ÙŠØ©
- [ ] UI Ù†Ø¸ÙŠÙ ÙˆØ§Ø­ØªØ±Ø§ÙÙŠ
- [ ] HANDOFF Ù„Ù„Ù…Ø·ÙˆØ± 6

---

## âœ… Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‚Ø¨ÙˆÙ„

**ÙŠÙÙ‚Ø¨Ù„ Ø¹Ù†Ø¯Ù…Ø§**:
- [x] âœ… Terminal ÙŠÙØªØ­ Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡
- [x] âœ… ÙŠÙ…ÙƒÙ† ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± bash
- [x] âœ… Output ÙŠØ¹Ø±Ø¶ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- [x] âœ… WebSocket Ù…Ø³ØªÙ‚Ø±
- [x] âœ… Git Tag: `dev5_complete`

---

## ğŸ“Š ØªÙ‚Ø¯ÙŠØ± Ø§Ù„ÙˆÙ‚Øª

| Ø§Ù„Ù…Ø±Ø­Ù„Ø© | Ø§Ù„ÙˆÙ‚Øª |
|---------|-------|
| Phase 1: Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ | 4 Ø³Ø§Ø¹Ø§Øª |
| Phase 2: Terminal Component | 12 Ø³Ø§Ø¹Ø§Øª |
| Phase 3: WebSocket Server | 8 Ø³Ø§Ø¹Ø§Øª |
| Phase 4: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± | 6 Ø³Ø§Ø¹Ø§Øª |
| Phase 5: Polish | 2 Ø³Ø§Ø¹Ø§Øª |
| **Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹** | **32 Ø³Ø§Ø¹Ø© (4-5 Ø£ÙŠØ§Ù…)** |

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«**: 2025-11-18  
**Ø§Ù„Ø­Ø§Ù„Ø©**: âœ… Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ†ÙÙŠØ°  
**ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø¬Ù‡Ø¯**: 4-5 Ø£ÙŠØ§Ù… (32 Ø³Ø§Ø¹Ø©)
